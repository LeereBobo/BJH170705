<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>灰色度</title>
		<style type="text/css">
			
		</style>
	</head>

	<body>
		<canvas id="canvas" width="550" height="800"></canvas>
	</body>

	<script type="text/javascript">
		var canvas = document.getElementById("canvas");
		var ctx = canvas.getContext("2d");
		
		//1.绘制图片
		var img = new Image();
		
		img.src = "0.jpg";
		img.onload = function() {
			ctx.beginPath();
			ctx.drawImage(img,0,0,canvas.width,canvas.height);
			
//			var data = ctx.getImageData(img,20,20,1,1);
//			data.data[0] = 255;
//			data.data[1] = 0;
//			data.data[2] = 0;
//			data.data[3] = 255;
//			ctx.putImageData(data,20,20);//20 20为放置的水平坐标与垂直坐标

			//获取数据
			var imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
			var piexls = imageData.data;
			
			
			
//			console.log(piexls.length);
			//遍历色素点
			for (var i = 0; i < piexls.length; i+=4) {
				var r = piexls[i];
				var g = piexls[i+1];
				var b = piexls[i+2];
				
				//重新赋值
				var gray = (r + g + b) / 3;
				piexls[i] = gray;
				piexls[i+1] = gray;
				piexls[i+2] = gray;
			}
			ctx.putImageData(imageData,100,100);
			ctx.closePath();
		}
	</script>

</html>